# [개발 로그] AI 얼굴 인식 대시보드 만들기: 삽질과 해결의 기록

## 1. 프로젝트 시작: "얼굴을 알아보는 웹 앱을 만들자"
**목표**: 웹캠으로 내 얼굴을 인식하고, 등록된 사람의 이름을 띄워주는 대시보드를 만들기로 함.
**스택 선정**:
- **언어**: Python
- **웹 프레임워크**: Streamlit (빠르게 UI를 만들기 위해)
- **AI 모델**: Facenet-PyTorch (InceptionResnetV1)
- **영상 처리**: OpenCV

## 2. 핵심 기능 구현 (Milestone 1~2)
처음에는 단순히 얼굴을 잡는 것부터 시작했다.
- `MTCNN`을 사용해서 얼굴 위치를 찾고 네모 박스를 그렸다.
- `OpenCV`로 웹캠 영상을 받아오는 `Camera` 클래스를 만들었다.

## 3. 얼굴 인식 기능 추가 (Milestone 3~4)
단순히 "얼굴이 있다"가 아니라 "누구냐"를 알아맞혀야 했다.
- **임베딩 추출**: 얼굴 이미지를 숫자 벡터(임베딩)로 변환하는 `InceptionResnetV1` 모델을 추가했다.
- **거리 계산**: 미리 등록된 얼굴의 벡터와 현재 얼굴 벡터의 거리를 계산해서, 가장 가까운 사람을 찾도록 구현했다.

## 4. 트러블슈팅 & UI 개선 (가장 고생했던 부분!) 

### 문제 1: 한글 이름이 깨짐 🔲
- **현상**: 얼굴 위에 이름을 띄우니 `???`로 나옴. OpenCV는 한글 지원이 안 됨.
- **해결**: `Pillow` 라이브러리를 도입해서 이미지에 글자를 그리고 다시 OpenCV 포맷으로 변환. 윈도우 기본 폰트(`malgun.ttf`)를 연결해서 해결!

### 문제 2: 카메라가 자꾸 꺼짐 📸
- **현상**: 이름을 입력하려고 키보드를 치거나, 등록 버튼을 누르면 화면이 깜빡이거나 카메라가 꺼져버림. Streamlit이 입력값이 바뀔 때마다 전체 코드를 다시 실행(Rerun)하는 특성 때문.
- **해결 1차**: 입력 폼(`st.form`)을 써서 엔터 칠 때만 실행되게 함. -> 여전히 삭제할 때 꺼짐.
- **해결 2차 (최종)**: `Session State`에 카메라 객체를 저장해서, 코드가 다시 실행돼도 카메라 연결은 끊기지 않고 유지되도록 구조를 완전히 바꿈. (이게 신의 한 수!)

### 문제 3: "서버 연결 거부" 🚫
- **현상**: 코드를 고치다 보니 백그라운드에서 파이썬 프로세스가 4개나 돌아가고 있었음. 카메라 자원을 서로 뺏으려고 싸우느라 오류 발생.
- **해결**: `taskkill` 명령어로 싹 정리하고 재부팅 수준으로 깔끔하게 재시작.

## 5. 최종 완성 (Milestone 5)
- **UI 한국어 패치**: 버튼, 알림창을 모두 한국어로 변경.
- **얼굴 관리**: 사이드바에서 쉽고 직관적으로 얼굴을 등록하고 삭제할 수 있게 됨.
- **안정성**: 이제 뭘 눌러도 카메라가 안 꺼짐!

## 6. 후기
처음에는 간단할 줄 알았는데, Streamlit의 작동 방식(Rerun) 때문에 카메라 연결을 유지하는 게 제일 까다로웠다. 하지만 결국 `Class`와 `Session State`를 활용해서 해결했을 때의 쾌감이 컸다. AI 코딩 어시스턴트와 함께 핑퐁하며 문제를 하나씩 격파해 나가는 과정이 즐거웠다.

---
*이 프로젝트의 코드는 [GitHub 저장소 링크]에서 확인할 수 있습니다.*
